Tables of contens
=================
* [I. Tá»•ng quan](#i-tá»•ng-quan-vá»-mÃ£-khÃ³a-Ä‘á»‘i-xá»©ng)
  * [1. Máº­t mÃ£ Ä‘á»‘i xá»©ng lÃ  gÃ¬](#1-máº­t-mÃ£-Ä‘á»‘i-xá»©ng-lÃ -gÃ¬-)
  * [2. Má»™t vÃ i thÃ´ng tin phá»¥](#2-má»™t-vÃ i-thÃ´ng-tin-bá»•-xung)
  * [3. MÃ£ khÃ³a](#3-cÃ¡c-loáº¡i-mÃ£-khÃ³a)

## I. Tá»•ng quan vá» mÃ£ khÃ³a Ä‘á»‘i xá»©ng

### 1. Máº­t mÃ£ Ä‘á»‘i xá»©ng lÃ  gÃ¬ ?

Máº­t mÃ£ khÃ³a Ä‘á»‘i xá»©ng lÃ  má»™t loáº¡i sÆ¡ Ä‘á»“ mÃ£ hÃ³a trong Ä‘Ã³ má»™t khÃ³a giá»‘ng nhau sáº½ vá»«a Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ mÃ£ hÃ³a, vá»«a Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ giáº£i mÃ£ cÃ¡c tá»‡p tin. Máº­t mÃ£ khÃ³a Ä‘á»‘i xá»©ng Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trÃªn nhiá»u há»‡ thá»‘ng mÃ¡y tÃ­nh khÃ¡c nhau nháº±m tÄƒng cÆ°á»ng báº£o máº­t cho dá»¯ liá»‡u. Má»™t sÆ¡ Ä‘á»“ mÃ£ hÃ³a Ä‘á»‘i xá»©ng thÆ°á»ng sá»­ dá»¥ng má»™t khÃ³a Ä‘Æ¡n Ä‘Æ°á»£c chia sáº» giá»¯a 2 hoáº·c nhiá»u ngÆ°á»i dÃ¹ng vá»›i nhau. KhÃ³a duy nháº¥t nÃ y sáº½ Ä‘Æ°á»£c dÃ¹ng cho cáº£ 2 tÃ¡c vá»¥ mÃ£ hÃ³a vÃ  giáº£i mÃ£ cÃ¡c vÄƒn báº£n thÃ´ (cÃ¡c tin nháº¯n hoáº·c máº£nh dá»¯ liá»‡u cáº§n Ä‘Æ°á»£c mÃ£ hÃ³a). CÃ¡c thuáº­t toÃ¡n khÃ³a Ä‘á»‘i xá»©ng Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trÃªn nhiá»u há»‡ thá»‘ng mÃ¡y tÃ­nh khÃ¡c nhau nháº±m tÄƒng cÆ°á»ng báº£o máº­t cho dá»¯ liá»‡u. Má»©c Ä‘á»™ báº£o máº­t cá»§a cÃ¡c há»‡ thá»‘ng mÃ£ hÃ³a Ä‘á»‘i xá»©ng sáº½ phá»¥ thuá»™c vÃ o Ä‘á»™ khÃ³ trong viá»‡c suy Ä‘oÃ¡n ngáº«u nhiÃªn ra khÃ³a Ä‘á»‘i xá»©ng theo hÃ¬nh thá»©c táº¥n cÃ´ng brute force. Trong sá»‘ cÃ¡c sÆ¡ Ä‘á»“ mÃ£ hÃ³a Ä‘á»‘i xá»©ng Ä‘Æ°á»£c sá»­ dá»¥ng ngÃ y nay thÃ¬ cÃ³ 2 loáº¡i thÃ´ng dá»¥ng nháº¥t lÃ  ná»n táº£ng máº­t mÃ£ block vÃ  stream.

### 2. Má»™t vÃ i thÃ´ng tin bá»• xung

- Má»™t trong nhá»¯ng mÃ£ khÃ³a Ä‘á»‘i xá»©ng phá»• biáº¿n nháº©t Ä‘áº¿n hiá»‡n táº¡i lÃ  AES Ä‘Æ°á»£c cÃ´ng bá»‘ nÄƒm 2001. HiÃªn táº¡i nÃ³ phá»• biáº¿n tá»›i mÆ°c má»™t sá»‘ pháº§n mÃªm mÃ¡y tÃ­nh cÃ³ pháº§n tá»‡p lá»‡nh riÃªng Ä‘á»ƒ thá»±c hiÃªn AES. !) nÃ³ lÃ  má»™t mÃ£ khÃ³a hay cÃ³ trong CTF nÃªn cáº§n táº­p trung vÃ o nÃ³.
- Vá» cÆ¡ báº£n mÃ£ khÃ³a Ä‘á»‘i xá»©ng Ä‘Æ°á»£c chia lÃ m hai loáº¡i cÆ¡ báº£n lÃ  MÃ£ khÃ³a khá»‘i (block cipher) vÃ  MÃ£ khÃ³a dÃ²ng (stream cipher)
  - MÃ£ khÃ³a khá»‘i lÃ  mÃ£ khÃ³a mÃ£ khÃ³a chia cÃ¡c Ä‘oáº¡n báº£n rÃµ thÃ nh cÃ¡c pháº§n báº±ng nhau rá»“i mÃ£ khÃ³a láº§n lÆ°á»£t tá»«ng pháº§n (AES, DES, ...) vá»›i cÃ¹ng má»™t key.
  - MÃ£ khÃ³a dÃ²ng lÃ  mÃ£ khÃ³a mÃ  khi mÃ£ khÃ³a nÃ³ chá»‰ mÃ£ khÃ³a tá»«ng bytes hoáº·c nhiá»u bytes báº±ng cÃ¡ch xor nÃ³ vá»›i má»™t loáº¡t cÃ¡c khÃ³a giáº£ (cÅ©ng lÃ  AES, DES, ...)
- MÃ£ khÃ³a Ä‘á»‘i xá»©ng chá»‰ Ä‘áº·c biá»‡t á»Ÿ cÃ¡ch nÃ³ mÃ£ khÃ³a tá»«ng khá»‘i vÃ  mode mÃ£ khÃ³a cá»§a nÃ³. ÄÃ¢y lÃ  Ä‘iá»ƒm khiáº¿n nÃ³ trá»Ÿ nÃªn khÃ³ phÃ¡ vá»¡ náº¿u hÃ´ng Ä‘á»§ am hiá»ƒu vá» loáº¡i mÃ£ vÃ  mode Ä‘Ã³ thÃ¬ viá»‡c phÃ¡ nÃ³ gáº§n nhÆ° lÃ  khÃ´ng thá»ƒ.
- KhÃ´ng hiá»ƒu sao cÃ¡c mÃ£ khÃ³a cÆ¡ báº£n nhÆ° ceasar, hill cÃ¡c thá»© cÅ©ng cÃ¹ng lÃ  mx khÃ³a Ä‘á»‘i xá»©ng mÃ  khÃ´ng tháº¥y nÃ³i Ä‘áº¿n ğŸ™ƒ

### 3. CÃ¡c loáº¡i mÃ£ khÃ³a

#### 1. DES (data encrpyted standard)

a. Tá»•ng quan vá» DES

+ ÄÆ°á»£c phÃ¡t triá»ƒn bá»Ÿi NIST nÄƒm 1977
+ Äáº§u vÃ o cá»§a DES lÃ  cÃ¡c block 64 bit vÃ  cÃ¡c Ä‘áº§u ra cÅ©ng cÃ³ 64 bit.
+ Vá»›i khÃ³a k cÃ³ Ä‘á»™ dÃ i 56 bit(thá»±c ra ban Ä‘áº§u lÃ  64 bit nhÆ°ng trong quÃ¡ trÃ¬nh mÃ£ hÃ³a cÃ¡c bit chia háº¿t cho 8 Ä‘Æ°á»£c láº¥y Ä‘á»ƒ kiá»ƒm tra tÃ­nh cháº¯n láº» nÃªn cÃ²n láº¡i 56)
+ Thuáº­t toÃ¡n : ÄÃ¢u tiÃªn trÆ°á»›c khi Ä‘i vÃ o mÃ£ hÃ³a nÃ³ sáº½ chia thÃ´ng tin cá»§a báº£n rÃµ thÃ nh cÃ¡c khá»‘i 64 bit, tá»«ng khá»‘i nÃ y sáº½ láº§n lÆ°á»£t Ä‘Æ°á»£c Ä‘Æ°a vÃ o mÃ£ hÃ³a. Má»—i láº§n mÃ£ hÃ³a sáº½ cÃ³ 16 chu trÃ¬nh chÃ­nh.

b. Chi tiáº¿t

cÃ³ 16 vÃ²ng:

á»Ÿ vÃ²ng 1 chÃºng ta lÃ m cÃ¡c viá»‡c sau:

Pháº§n táº¡o khÃ³a:
  
+ Tá»« khÃ³a 64 bit ban Ä‘áº§u qua pháº§n (HoÃ¡n vá»‹ PC-1) Permuted choice - 1 loáº¡i bá» cÃ¡c bit á»Ÿ vá»‹ trÃ­ chia háº¿t cho 8(tá»« Ä‘Ã³ khÃ³a cÃ²n láº¡i 56 bit). TÃ¡ch cÃ¡c bit cÃ²n láº¡i lÃ m 2 pháº§n má»—i pháº§n cÃ³ 28 bá»‰t lÃ  28 bit Ä‘áº§u vÃ  28 bit cuá»‘i(kÃ½ hiá»‡u: 28 bit Ä‘áº§u $C_0$, 28 bit cuá»‘i $D_0$)
+ Dá»‹ch trÃ¡i: á»Ÿ cÃ¡c vÃ²ng(1, 2, 9, 16) thÃ¬ ta dich trÃ¡i 1 bit, cÃ¡c vÃ²ng cÃ²n láº¡i dá»‹ch trÃ¡i 2 bit.
+ Sau khi dá»‹ch vÃ²ng trÃ¡i cho C0 vÃ  D0 thÃ¬ ta sáº½ cho vÃ o hoÃ¡n vá»‹ PC-2 . HoÃ¡n vá»‹ PC-2 vá» cÆ¡ báº£n lÃ  giá»‘ng hoÃ¡n vá»‹ PC-1 chá»‰ khÃ¡c á»Ÿ sá»± hoÃ¡n vá»‹ khi cÃ¡c bÃ­t 9, 18, 25, 35, 38, 43 bá»‹ lÆ°á»£c bá». Khi nÃ y Ä‘áº§u ra cá»§a nÃ³ sáº½ lÃ  18.LÆ°u láº¡i káº¿t quáº£ sau khi vÃ²ng dá»‹ch trÃ¡i rá»“i gÃ¡n nÃ³ vÃ o C1, D1

Pháº§n input:

- Cho 64 bit qua hoÃ¡n vá»‹ Sau Ä‘Ã³ láº¥y 64 bit chia lÃ m 2 pháº§n $l_0$ vÃ  $R_0$. ÄÆ°a $R_0$ qua hoÃ¡n vá»‹ má»Ÿ rá»™ng E. Má»¥c Ä‘Ã­ch cá»§a nÃ³ lÃ  Ä‘á»ƒ tÄƒng sá»‘ bit lÃªn 48 Ä‘á»ƒ $XOR$ vá»›i cáº£ $key$ cÅ©ng cÃ³ 48 bits.

Báº£ng hoÃ¡n vá»‹

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/e445d333-af9d-4100-b77b-aba8fb5376d6)

- HoÃ¡n vá»‹ má»Ÿ rá»™ng E lÃ  láº·p láº¡i hai bit cuá»‘i cá»§a hÃ ng trÆ°á»›c hoáº·c hÃ ng sau.



  
- Sau khi $R_0$ xor vá»›i $K_0$ thÃ¬ ta cho nÃ³ qua vÃ²ng s-box Ä‘á»ƒ chuyá»ƒn nÃ³ vá» láº¡i 32 bit.
- Tiáº¿p tá»¥c cho hoÃ¡n vá»‹ PC-1. Sau Ä‘Ã³ láº¥y L0 Xor vá»›i káº¿t quáº£ vá»«a cÃ³. Rá»“i gÃ¡n báº±ng R1.
  
Tiáº¿p tá»±c lÃ m nhÆ° váº­y trong 16 vÃ²ng. Rá»“i cho qua hoÃ¡n vi IP(-1) thÃ¬ ta sáº½ cÃ³ dc ciphertext.

IP(-1) (Inverse initial permutation):

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/60b91532-f0b8-4f12-95b5-27fa87306ef0)

+ CÃ¡ch nhÃ¬n trá»±c quan mÃ£ hÃ³a DES:

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/35dc8acf-a6c4-4ebe-8e67-d883106ccfcb)

+ Tá»«ng vÃ²ng cá»§a DES:

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/fe33099f-e1ce-4c30-a461-78ede91a279e)

Váº­y ta cÃ³:
+ $l_{i} = R _ {i - 1}$
+ $R_{i} = L_{i - 1} \oplus F(R_{i - 1}, k_i)$


