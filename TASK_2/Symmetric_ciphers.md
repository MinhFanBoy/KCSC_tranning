Tables of contens
=================
* [I. Tá»•ng quan](#i-tá»•ng-quan-vá»-mÃ£-khÃ³a-Ä‘á»‘i-xá»©ng)
  * [1. Máº­t mÃ£ Ä‘á»‘i xá»©ng lÃ  gÃ¬](#1-máº­t-mÃ£-Ä‘á»‘i-xá»©ng-lÃ -gÃ¬-)
  * [2. Má»™t vÃ i thÃ´ng tin phá»¥](#2-má»™t-vÃ i-thÃ´ng-tin-bá»•-sung)
* [II. MÃ£ khÃ³a](#ii-cÃ¡c-loáº¡i-mÃ£-khÃ³a)

## I. Tá»•ng quan vá» mÃ£ khÃ³a Ä‘á»‘i xá»©ng

### 1. Máº­t mÃ£ Ä‘á»‘i xá»©ng lÃ  gÃ¬ ?

Máº­t mÃ£ khÃ³a Ä‘á»‘i xá»©ng lÃ  má»™t loáº¡i sÆ¡ Ä‘á»“ mÃ£ hÃ³a trong Ä‘Ã³ má»™t khÃ³a giá»‘ng nhau sáº½ vá»«a Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ mÃ£ hÃ³a, vá»«a Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ giáº£i mÃ£ cÃ¡c tá»‡p tin. Máº­t mÃ£ khÃ³a Ä‘á»‘i xá»©ng Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trÃªn nhiá»u há»‡ thá»‘ng mÃ¡y tÃ­nh khÃ¡c nhau nháº±m tÄƒng cÆ°á»ng báº£o máº­t cho dá»¯ liá»‡u. Má»™t sÆ¡ Ä‘á»“ mÃ£ hÃ³a Ä‘á»‘i xá»©ng thÆ°á»ng sá»­ dá»¥ng má»™t khÃ³a Ä‘Æ¡n Ä‘Æ°á»£c chia sáº» giá»¯a 2 hoáº·c nhiá»u ngÆ°á»i dÃ¹ng vá»›i nhau. KhÃ³a duy nháº¥t nÃ y sáº½ Ä‘Æ°á»£c dÃ¹ng cho cáº£ 2 tÃ¡c vá»¥ mÃ£ hÃ³a vÃ  giáº£i mÃ£ cÃ¡c vÄƒn báº£n thÃ´ (cÃ¡c tin nháº¯n hoáº·c máº£nh dá»¯ liá»‡u cáº§n Ä‘Æ°á»£c mÃ£ hÃ³a). CÃ¡c thuáº­t toÃ¡n khÃ³a Ä‘á»‘i xá»©ng Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trÃªn nhiá»u há»‡ thá»‘ng mÃ¡y tÃ­nh khÃ¡c nhau nháº±m tÄƒng cÆ°á»ng báº£o máº­t cho dá»¯ liá»‡u. Má»©c Ä‘á»™ báº£o máº­t cá»§a cÃ¡c há»‡ thá»‘ng mÃ£ hÃ³a Ä‘á»‘i xá»©ng sáº½ phá»¥ thuá»™c vÃ o Ä‘á»™ khÃ³ trong viá»‡c suy Ä‘oÃ¡n ngáº«u nhiÃªn ra khÃ³a Ä‘á»‘i xá»©ng theo hÃ¬nh thá»©c táº¥n cÃ´ng brute force. Trong sá»‘ cÃ¡c sÆ¡ Ä‘á»“ mÃ£ hÃ³a Ä‘á»‘i xá»©ng Ä‘Æ°á»£c sá»­ dá»¥ng ngÃ y nay thÃ¬ cÃ³ 2 loáº¡i thÃ´ng dá»¥ng nháº¥t lÃ  ná»n táº£ng máº­t mÃ£ block vÃ  stream.

### 2. Má»™t vÃ i thÃ´ng tin bá»• sung

- Má»™t trong nhá»¯ng mÃ£ khÃ³a Ä‘á»‘i xá»©ng phá»• biáº¿n nháº©t Ä‘áº¿n hiá»‡n táº¡i lÃ  AES Ä‘Æ°á»£c cÃ´ng bá»‘ nÄƒm 2001. HiÃªn táº¡i nÃ³ phá»• biáº¿n tá»›i mÆ°c má»™t sá»‘ pháº§n mÃªm mÃ¡y tÃ­nh cÃ³ pháº§n tá»‡p lá»‡nh riÃªng Ä‘á»ƒ thá»±c hiÃªn AES. !) nÃ³ lÃ  má»™t mÃ£ khÃ³a hay cÃ³ trong CTF nÃªn cáº§n táº­p trung vÃ o nÃ³.
- Vá» cÆ¡ báº£n mÃ£ khÃ³a Ä‘á»‘i xá»©ng Ä‘Æ°á»£c chia lÃ m hai loáº¡i cÆ¡ báº£n lÃ  MÃ£ khÃ³a khá»‘i (block cipher) vÃ  MÃ£ khÃ³a dÃ²ng (stream cipher)
  - MÃ£ khÃ³a khá»‘i lÃ  mÃ£ khÃ³a mÃ£ khÃ³a chia cÃ¡c Ä‘oáº¡n báº£n rÃµ thÃ nh cÃ¡c pháº§n báº±ng nhau rá»“i mÃ£ khÃ³a láº§n lÆ°á»£t tá»«ng pháº§n (AES, DES, ...) vá»›i cÃ¹ng má»™t key.
  - MÃ£ khÃ³a dÃ²ng lÃ  mÃ£ khÃ³a mÃ  khi mÃ£ khÃ³a nÃ³ chá»‰ mÃ£ khÃ³a tá»«ng bytes hoáº·c nhiá»u bytes báº±ng cÃ¡ch xor nÃ³ vá»›i má»™t loáº¡t cÃ¡c khÃ³a giáº£ (cÅ©ng lÃ  AES, DES, ...)
- MÃ£ khÃ³a Ä‘á»‘i xá»©ng chá»‰ Ä‘áº·c biá»‡t á»Ÿ cÃ¡ch nÃ³ mÃ£ khÃ³a tá»«ng khá»‘i vÃ  mode mÃ£ khÃ³a cá»§a nÃ³. ÄÃ¢y lÃ  Ä‘iá»ƒm khiáº¿n nÃ³ trá»Ÿ nÃªn khÃ³ phÃ¡ vá»¡ náº¿u hÃ´ng Ä‘á»§ am hiá»ƒu vá» loáº¡i mÃ£ vÃ  mode Ä‘Ã³ thÃ¬ viá»‡c phÃ¡ nÃ³ gáº§n nhÆ° lÃ  khÃ´ng thá»ƒ.
- KhÃ´ng hiá»ƒu sao cÃ¡c mÃ£ khÃ³a cÆ¡ báº£n nhÆ° ceasar, hill cÃ¡c thá»© cÅ©ng cÃ¹ng lÃ  mx khÃ³a Ä‘á»‘i xá»©ng mÃ  khÃ´ng tháº¥y nÃ³i Ä‘áº¿n ğŸ™ƒ

## II. CÃ¡c loáº¡i mÃ£ khÃ³a

### 1. DES (data encrpyted standard)

a. Tá»•ng quan vá» DES

+ ÄÆ°á»£c phÃ¡t triá»ƒn bá»Ÿi NIST nÄƒm 1977
+ Äáº§u vÃ o cá»§a DES lÃ  cÃ¡c block 64 bit vÃ  cÃ¡c Ä‘áº§u ra cÅ©ng cÃ³ 64 bit.
+ Vá»›i khÃ³a k cÃ³ Ä‘á»™ dÃ i 56 bit(thá»±c ra ban Ä‘áº§u lÃ  64 bit nhÆ°ng trong quÃ¡ trÃ¬nh mÃ£ hÃ³a cÃ¡c bit chia háº¿t cho 8 Ä‘Æ°á»£c láº¥y Ä‘á»ƒ kiá»ƒm tra tÃ­nh cháº¯n láº» nÃªn cÃ²n láº¡i 56)
+ Thuáº­t toÃ¡n : ÄÃ¢u tiÃªn trÆ°á»›c khi Ä‘i vÃ o mÃ£ hÃ³a nÃ³ sáº½ chia thÃ´ng tin cá»§a báº£n rÃµ thÃ nh cÃ¡c khá»‘i 64 bit, tá»«ng khá»‘i nÃ y sáº½ láº§n lÆ°á»£t Ä‘Æ°á»£c Ä‘Æ°a vÃ o mÃ£ hÃ³a. Má»—i láº§n mÃ£ hÃ³a sáº½ cÃ³ 16 chu trÃ¬nh chÃ­nh.

b. Chi tiáº¿t


Pháº§n táº¡o khÃ³a:
  
+ Tá»« khÃ³a 64 bit ban Ä‘áº§u qua pháº§n (HoÃ¡n vá»‹ PC-1) Permuted choice - 1 loáº¡i bá» cÃ¡c bit á»Ÿ vá»‹ trÃ­ chia háº¿t cho 8(tá»« Ä‘Ã³ khÃ³a cÃ²n láº¡i 56 bit). TÃ¡ch cÃ¡c bit cÃ²n láº¡i lÃ m 2 pháº§n má»—i pháº§n cÃ³ 28 bá»‰t lÃ  28 bit Ä‘áº§u vÃ  28 bit cuá»‘i(kÃ½ hiá»‡u: 28 bit Ä‘áº§u $C_0$, 28 bit cuá»‘i $D_0$)
+ Dá»‹ch trÃ¡i: á»Ÿ cÃ¡c vÃ²ng(1, 2, 9, 16) thÃ¬ ta dich trÃ¡i 1 bit, cÃ¡c vÃ²ng cÃ²n láº¡i dá»‹ch trÃ¡i 2 bit.
+ Sau khi dá»‹ch vÃ²ng trÃ¡i cho $C_0$ vÃ  $D_0$ thÃ¬ ta sáº½ cho vÃ o hoÃ¡n vá»‹ PC-2 . HoÃ¡n vá»‹ PC-2 vá» cÆ¡ báº£n lÃ  giá»‘ng hoÃ¡n vá»‹ PC-1 chá»‰ khÃ¡c á»Ÿ sá»± hoÃ¡n vá»‹ khi cÃ¡c bÃ­t 9, 18, 25, 35, 38, 43 bá»‹ lÆ°á»£c bá». Khi nÃ y Ä‘áº§u ra cá»§a nÃ³ sáº½ lÃ  18. LÆ°u láº¡i káº¿t quáº£ sau khi vÃ²ng dá»‹ch trÃ¡i rá»“i gÃ¡n nÃ³ vÃ o $C_1$, $D_1$

Pháº§n input:
+ CÃ¡ch nhÃ¬n trá»±c quan mÃ£ hÃ³a DES:

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/35dc8acf-a6c4-4ebe-8e67-d883106ccfcb)

+ Tá»«ng vÃ²ng cá»§a DES:

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/fe33099f-e1ce-4c30-a461-78ede91a279e)


> Báº¯t Ä‘áº§u
- Cho 64 bit qua hoÃ¡n vá»‹ Sau Ä‘Ã³ láº¥y 64 bit chia lÃ m 2 pháº§n $l_0$ vÃ  $R_0$.
  
![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/e445d333-af9d-4100-b77b-aba8fb5376d6)

- $R_0$ Ä‘Æ°á»£c Ä‘Æ°a vÃ o hÃ m F.
  
![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/b313f020-d7c2-4957-b188-c12f8b82fff6)

> BÃªn trong hÃ m F()

- ÄÆ°a $R_0$ qua hoÃ¡n vá»‹ má»Ÿ rá»™ng E. HoÃ¡n vá»‹ má»Ÿ rá»™ng E lÃ  láº·p láº¡i hai bit cuá»‘i cá»§a hÃ ng trÆ°á»›c hoáº·c hÃ ng sau. Má»¥c Ä‘Ã­ch cá»§a nÃ³ lÃ  Ä‘á»ƒ tÄƒng sá»‘ bit lÃªn 48 Ä‘á»ƒ $XOR$ vá»›i cáº£ $key$ cÅ©ng cÃ³ 48 bits.


![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/78a27ded-a166-4310-b2e0-d2294ea221fb)

- Sau khi $R_0$ xor vá»›i $K_0$ thÃ¬ ta cho nÃ³ qua vÃ²ng s-box Ä‘á»ƒ chuyá»ƒn nÃ³ vá» láº¡i 32 bit.

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/1c374294-e742-4df6-9be9-5e91b665efe1)

- Tiáº¿p tá»¥c cho hoÃ¡n vá»‹ PC-1. Sau Ä‘Ã³ láº¥y $L_0$ $XOR$ vá»›i káº¿t quáº£ vá»«a cÃ³. Rá»“i gÃ¡n báº±ng $R_1$.

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/83470541-6257-4c8e-9556-53d87046adba)
> Káº¿t thÃºc hÃ m F()

Sau Ä‘Ã³ ta Ä‘áº·t:

+ $l_{i} = R _ {i - 1}$
+ $R_{i} = L_{i - 1} \oplus F(R_{i - 1}, k_i)$

Láº¥y pháº§n $L _ {i}, R _ {i}$ tiáº¿p tá»¥c thá»±c hÃ m nhÆ° trÃªn.

> Sau 16 vÃ²ng

Tiáº¿p tá»¥c lÃ m nhÆ° váº­y trong 16 vÃ²ng. Rá»“i cho qua hoÃ¡n vi IP(-1) thÃ¬ ta sáº½ cÃ³ dc ciphertext.

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/60b91532-f0b8-4f12-95b5-27fa87306ef0)


Váº­y ta cÃ³:
+ $l_{i} = R _ {i - 1}$
+ $R_{i} = L_{i - 1} \oplus F(R_{i - 1}, k_i)$

c. ThÃ´ng tin thÃªm

+ DES cÃ³ hiá»‡u á»©ng tuyáº¿t lá»Ÿ máº¡nh:
  + vá»›i má»—i má»™t bit plaintext bá»‹ thay Ä‘á»•i cÃ³ thá»ƒ thay Ä‘á»•i Ã­t nháº¥t 34 bit á»Ÿ ciphertext
  + Má»—i má»™t bit á»Ÿ Key bá»‹ thay Ä‘á»•i khiáº¿n ciphertext thay Ä‘á»•i Ã­t nháº¥t 35 bit
+ Vá»›i khÃ³a tháº­t sá»± Ä‘Æ°á»£c dÃ¹ng trong DES lÃ  56( Thay vÃ¬ 64 nhÆ° Ä‘áº§u vÃ o) thÃ¬ Ä‘á»ƒ bruteforce táº¥t cáº£ key (giáº£ sá»­ má»—i láº§n giáº£i mÃ£ máº¥t má»™t giÃ¢y) thÃ¬ ta tá»‘n hÆ¡n 1000 nÄƒm Ä‘á»ƒ hoÃ n thÃ nh
+ Hiá»‡n táº¡i DES Ä‘Æ°á»£c xem lÃ  khÃ´ng an toÃ n ná»¯a.

### 2. 3DES

a. Tá»•ng quan vá» 3DES

+ CÅ©ng lÃ  DES nhÆ°ng Ä‘Æ°á»£c mÃ£ hÃ³a nhiá»u láº§n vá»›i cÃ¡c key khÃ¡c nhau.
+ YÃªu cáº§u Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra cÅ©ng giá»‘ng nhÆ° DES.
+ TrÃ¡nh Ä‘Æ°á»£c viá»‡c bá»‹ bruteforce hay táº¥n cÃ´ng khÃ¡c.

b. 3DES

+ 2DES: Sau khi mÃ£ hÃ³a láº§n 1 ta láº¥y ciphertext Ä‘Ã³ lÃ m plaintext cá»§a láº§n 2 vÃ  mÃ£ hÃ³a. Viá»‡c giáº£i mÃ£ thÃ¬ ta giáº£i mÃ£ vá»›i trÃ¬nh tá»± ngÆ°á»£c láº¡i, láº¥y ciphertext cá»§a láº§n mÃ£ hÃ³a thá»© 2 mÃ£ hÃ³a trÆ°á»›c xong tiáº¿p tá»¥c mÃ£ hÃ³a nÃ³ lÃ  ta sáº½ cÃ³ thÃ´ng tin ban Ä‘áº§u.

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/01b82852-8e66-4161-bdea-2747d6a66ab5)

+ 3DES: Ta thá»±c hiÃªn nhÆ° sau: Láº¥y plaintext mÃ£ hÃ³a vá»›i $key_1$, giáº£i mÃ£ báº±ng $key_2$ xong rá»“i tiáº¿p tá»¥c mÃ£ hÃ³a báº±ng $key_1$.

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/2cf7808c-0bfa-4f6e-8f77-9faeb2029f6b)

c. ThÃ´ng tin thÃªm
+ 2DES Ä‘Ã£ bá»‹ phÃ¡ vá»¡ bá»Ÿi cÃ¡c cuá»™c táº¥n cÃ´ng vÃ¬ Ä‘á»™ dÃ i khÃ³a quÃ¡ ngáº¯n.
+ 3DES sá»­ dá»¥ng ba khÃ³a DES Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u, má»—i khÃ³a cÃ³ Ä‘á»™ dÃ i 56 bit. 3DES Ä‘Æ°á»£c coi lÃ  má»™t phiÃªn báº£n an toÃ n hÆ¡n cá»§a DES vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong cÃ¡c sáº£n pháº©m máº­t mÃ£ dÃ¢n sá»±. 3DES cÅ©ng Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c sáº£n pháº©m báº£o máº­t nhÆ° tháº» tÃ­n dá»¥ng vÃ  cÃ¡c sáº£n pháº©m báº£o máº­t thÃ´ng tin khÃ¡c

### 3. AES(advanced encryption standard)

a. Tá»•ng quan
+ ÄÆ°á»£c phÃ¡t triá»ƒn bá»Ÿi NIST nÄƒm 2001.
+ **AES (Advanced Encryption Standard)** lÃ  má»™t thuáº­t toÃ¡n mÃ£ hÃ³a khá»‘i Ä‘á»‘i xá»©ng Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong cÃ¡c sáº£n pháº©m báº£o máº­t thÃ´ng tin. Thuáº­t toÃ¡n nÃ y Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ thay tháº¿ cho thuáº­t toÃ¡n DES (Data Encryption Standard) cÅ© hÆ¡n. AES sá»­ dá»¥ng kÃ­ch thÆ°á»›c khá»‘i 128 bit vÃ  cÃ³ ba kÃ­ch thÆ°á»›c khÃ³a khÃ¡c nhau: 128, 192 vÃ  256 bit. AES Ä‘Æ°á»£c coi lÃ  má»™t trong nhá»¯ng thuáº­t toÃ¡n mÃ£ hÃ³a Ä‘á»‘i xá»©ng an toÃ n nháº¥t hiá»‡n nay.(Trong bÃ i viáº¿t nÃ y Ä‘á»ƒ dá»… rÃ ng hiá»ƒu vÃ  viáº¿t thÃ¬ mÃ¬nh chá»‰ viáº¿t vá»›i AES cÃ³ kÃ­ch thÆ°á»›c khÃ³a lÃ  128bit)

<picture>
  <img src="https://lilthawg29.files.wordpress.com/2021/06/image-2.png" width="30%" height="30%">
</picture>

+ Vá»›i plaintext = 128 bit, key = 128 bit, 192 bit, or 256 bit.
+ Trong khi mÃ£ hÃ³a cÃ³ cÃ¡c khÃ³a má»Ÿ rá»™ng Ä‘Æ°á»£c sinh ra tá»« chu trÃ¬nh Rijndeal. Háº§u háº¿t cÃ¡c phÃ©p toÃ¡n trong AES Ä‘á»u Ä‘Æ°á»£c thá»±c hiá»‡n trÃªn trÆ°á»ng há»¯u háº¡n cá»§a cÃ¡c bytes. Má»—i khá»‘i 128 bit dc chia thÃ nh 4 cá»™t vá»›i má»—i cá»™t 16 bytes xáº¿p thÃ nh má»™t ma tráº­n 4x4, cÃ²n dÆ°á»£c gá»i lÃ  ma tráº­n tráº¡ng thÃ¡i. TÃ¹y thuá»™c vÃ o Ä‘á»™ dÃ i cá»§a khÃ³a mÃ  ta cÃ³ sá»‘ láº§n láº·p trong má»™t vÃ²ng khÃ¡c nhau.
+ Gá»“m hai bÆ°á»›c chÃ­nh lÃ  BÆ°á»›c sinh khÃ³a(key generated) vÃ  mÃ£ hÃ³a(encrypt).

b. Chi tiáº¿t

+ Tá»•ng quÃ¡t cáº£ quÃ¡ trÃ¬nh mÃ£ hÃ³a:

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/ce64b0f9-770b-4e2e-a453-142eea0b2f01)

+ Chi tiáº¿t hÆ¡n:

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/0348bb66-dd0c-4f9b-9904-1b150f9abf13)

+ CÃ¡c bÆ°á»›c chÃ­nh:
   + b1 : Khá»Ÿi táº¡o plaintext káº¿t há»£p vá»›i key thÃ´ng qua addRoundKey
   + b2 : Láº·p mÃ£ hÃ³a, sá»­ dá»¥ng káº¿t quáº£ cá»§a bÆ°á»›c 1 rá»“i thÃ´ng qua 4 hÃ m chÃ­nh.
   + b3 : Sau N - 1 vÃ²ng, ta cho nÃ³ qua 3 hÃ m (bá» qua MixColumns) Ä‘á»ƒ hoÃ n thÃ nh mÃ£ hÃ³a.
  
+ CÃ³ N vÃ²ng láº·p vÃ  cÃ³ N-1 vÃ²ng láº·p chÃ­nh(1 -> N - 1).Chá»§ yáº¿u thá»±c hiá»‡n cÃ¡c hÃ m sau:
   + Subbytes - thay tháº¿ cÃ¡c bytes dá»¯ liá»‡u báº±ng bytes phá»¥
   + Shift rows - dá»‹ch vÃ²ng dá»¯ liá»‡u
   + Mix columns - trá»™n dá»¯u liá»‡u
   + AddRoundKeys - chÃ¨n khÃ³a vÃ²ng

+ HÃ m shift rows: LÃ  phÃ©p chuyá»ƒn Ä‘á»•i cÃ¡c pháº§n tá»­ trong hÃ ng, nÃ³ giá»¯ nguyÃªn hÃ ng Ä‘áº§u tiÃªn cá»§a ma tráº­n tráº¡ng thÃ¡i. HÃ ng thá»© hai Ä‘Æ°á»£c dá»‹ch chuyá»ƒn qua má»™t cá»™t á»Ÿ bÃªn trÃ¡i. HÃ ng thá»© ba Ä‘Æ°á»£c dá»‹ch chuyá»ƒn hai cá»™t, hÃ ng thá»© tÆ° Ä‘Æ°á»£c dá»‹ch chuyá»ƒn ba cá»™t.

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/7ee52c17-7d56-4723-8db2-0a6c070bd4bf)

 
+ HÃ m AddRoundKeys: HÃ m nÃ y sáº½ láº¥y giÃ¡ trá»‹ cá»§a tá»«ng pháº§n tá»­ cá»§a tráº¡ng thÃ¡i hiá»‡n táº¡i(plaintext Ä‘ang Ä‘Æ°á»£c mÃ£ hÃ³a) vá»›i tá»«ng pháº§n tá»­ táº¡i vá»‹ trÃ­ tÆ°Æ¡ng á»©ng cá»§a key
  
![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/411b7cc5-4ac4-44f7-942c-b65835dcaf39)

+ MixColums : HÃ m nÃ y thay Ä‘á»•i giÃ¡ trá»‹ cá»§a tá»«ng cá»™t báº±ng cÃ¡ch nhÃ¢n vá»›i ma tráº­n. NÃ³ cÃ²n Ä‘Æ°á»£c gá»i lÃ  hÃ m xtime(hÃ m nhÃ¢n x). MÃ¬nh sáº½ giáº£i thÃ­ch rÃµ hÃ m nÃ y hÆ¡n á»Ÿ pháº§n cÆ¡ sá»Ÿ toÃ¡n há»c.
  
<picture>
   <img src="https://lilthawg29.files.wordpress.com/2021/09/image-238.png?w=1024" width="70%" heigth="70%">
</picture>

+ SubBytes - má»—i bytes cá»§a state Ä‘Æ°á»£c thay tháº¿ báº±ng 1 bytes khÃ¡c trÃªn S-box
  - LÃ  quÃ¡ trÃ¬nh thay tháº¿ phi tuyáº¿n tÃ­nh trong Ä‘Ã³ má»—i bytes Ä‘Æ°á»£c thay tháº¿ báº±ng má»™t bytes khÃ¡c trong báº£ng tra
  - S-box lÃ  báº³ng 16 x 16 chá»©a hoÃ¡n vá»‹ cá»§a 256 kÃ½ tá»±
  - Má»—i bytes tráº¡ng thÃ¡i Ä‘Æ°á»£c thay tháº¿ bá»Ÿi 4 bit trÃ¡i vÃ  cá»™t xÃ¡c Ä‘á»‹nh bá»Ÿi 4 bit pháº£i, VD: 6D sáº½ Ä‘Æ°á»£c thay tháº¿ bá»Ÿi S-box[6][D]
  - Há»™p tháº¿ s-box Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn phÃ©p biáº¿n Ä‘á»•i phi tuyáº¿n (cÃ¡i nÃ y khÃ´ng hiá»ƒu láº¯m)
    
c. QuÃ¡ trÃ¬nh táº¡o khÃ³a má»Ÿ rá»™ng

+ KeyExpansion: ÄÆ°á»£c thá»±c hiá»‡n theo hÃ m quy náº¡p.
+ Vá»›i Rcon = [01, 02, 04, 08, 10, 20, 40, 80, 1b, 36]
+ Vá»›i 128 bit key ta cÃ³ Ä‘Æ°á»£c 16 bytes key, tá»« Ä‘Ã³ chia ra lÃ m 4 Ä‘oáº¡n key phá»¥ Ä‘Æ°á»£c goi lÃ  word Ä‘Æ°á»£c Ä‘Ã¡nh sá»‘ tá»« 0 Ä‘áº¿n 3.

![image](https://github.com/MinhFanBoy/KCSC_tranning/assets/145200520/35e4d27e-75fd-48f8-9007-36a84d1fbdc2)

+ cÃ¡c word sau Ä‘Æ°á»£c tÃ­nh theo cÃ´ng thá»©c nhÆ° sau:
  + $word_i = word_{i - 1} \oplus word_{i - 4}$ vá»›i má»i $4 \le t < 44$ vÃ  i khÃ´ng pháº£i lÃ  bá»™i cá»§a 4
  + $word_i = g(word_{i - 1}) \oplus word_{i - 4}$ vá»›i i lÃ  bá»™i cá»§a 4

<picture>
   <img src="https://lilthawg29.files.wordpress.com/2021/09/image-244.png?w=1024" width="70%" heigth="70%">
</picture>

+ HÃ m g() lÃ  hÃ m thay Ä‘á»•i gá»“m cÃ¡c bÆ°á»›c dá»‹ch trÃ¡i, Ä‘á»•i chá»— vá»›i s_box vÃ  xor vá»›i Rcon:
  + Dá»‹ch trÃ¡i 1 Ä‘Æ¡n vá»‹ cÃ¡c pháº§n tá»­ cá»§a word
  + Äá»•i chá»— vá»›i s_box(hÃ m nÃ£y cÅ©ng giá»‘ng hÃ n subbytes trong hÃ m chÃ­nh)
  + Xor vá»›i Rcon[i/4] vÃ¬ i khi nÃ y chi háº¿t cho 4.
    
d. CÆ¡ sá»Ÿ toÃ¡n há»c cá»§a AES
  + Trong AES cÃ¡c phÃ©p toÃ¡n Ä‘Æ°á»£c thá»±c hiá»‡n trÃªn trÆ°á»ng há»¯u háº¡n GF(2^8)
  + PhÃ©p cá»™ng: $A( a_1, a_2, a_3,..), B( b_1, b_2, b_3, ...)$ => $C = A + B = (c_1, c_2, c_3, ...)$ vá»›i $c_i = (a_i + b_i) \pmod{2}$
  + PhÃ©p nhÃ¢n: ÄÆ°á»£c thÆ°c hiá»‡n trÃªn trÆ°á»ng GF(2^8) báº±ng cÃ¡ch nhÃ¢n 2 Ä‘a thá»©c trong modul báº¥t kháº£ quy m(x).Trong AES $m(x) = x^8 + x^4 + x^3 + x + 1$
  + PhÃ©p xtime: (lÃ  phÃ©p nhÃ¢n vá»›i x) Ä‘á»c k hiá»ƒu j cáº£ hic

e. Äá»™ an toÃ n
  + tÃ­nh cháº¥t phá»©c táº¡p cá»§a biá»ƒu thá»©c s-box trÃªn $GF(2^8)$ cÃ¹ng vá»›i hiá»‡u á»©ng khuáº¿ch tÃ¡n giÃºp cho thuáº­t toÃ¡n khÃ´ng bá»‹ phÃ¢n tÃ­ch báº±ng phÆ°Æ¡ng phÃ¡p ná»™i suy
  + Rcon khÃ¡c nhau háº¡n cháº¿ tÃ­nh Ä‘á»‘i xá»©ng
  + TÃ­nh cháº¥t phi tuyáº¿n tÃ­nh
  + CÃ¡c cáº¥u trÃºc hÃ³a giáº£i mÃ£ khÃ¡c nhau háº¡n cháº¿ Ä‘Æ°á»£c khÃ³a yáº¿u

### 4. PKCS#7

CÃ¡c loáº¡i má»Ÿ rá»™ng thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ kÃ½ hiá»‡u: $.p7b, .p7s, .p7m, .p7c, .p7r$

PhÃ¡t triá»ƒn bá»Ÿi	RSA Security, 1 March 1998

PKCS#7 lÃ  má»™t chuáº©n cÃº phÃ¡p cho viá»‡c lÆ°u trá»¯ dá»¯ liá»‡u Ä‘Æ°á»£c kÃ½ vÃ /hoáº·c mÃ£ hÃ³a. NÃ³ lÃ  má»™t trong cÃ¡c chuáº©n thuá»™c há» chuáº©n mÃ£ hÃ³a khÃ³a cÃ´ng khai (PKCS) Ä‘Æ°á»£c táº¡o ra bá»Ÿi RSA Laboratories. Chuáº©n nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong cÃ¡c á»©ng dá»¥ng báº£o máº­t thÃ´ng tin, vÃ­ dá»¥ nhÆ° Ä‘á»ƒ lÆ°u trá»¯ chá»©ng chá»‰ vÃ  danh sÃ¡ch thu há»“i chá»©ng chá»‰ (CRL). PhiÃªn báº£n má»›i nháº¥t cá»§a chuáº©n PKCS#7 lÃ  1.5 vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong RFC 2315. Chuáº©n nÃ y cho phÃ©p Ä‘á»‡ quy, thuá»™c tÃ­nh, vÃ  cÃ¡c loáº¡i ná»™i dung khÃ¡c nhau, cháº³ng háº¡n nhÆ° dá»¯ liá»‡u, dá»¯ liá»‡u Ä‘Ã£ kÃ½, dá»¯ liá»‡u Ä‘Ã£ gá»­i vÃ  dá»¯ liá»‡u Ä‘Ã£ kÃ½ vÃ  gá»­i. NÃ³ cÅ©ng cho phÃ©p lÆ°u trá»¯ chá»©ng chá»‰ vÃ /hoáº·c danh sÃ¡ch thu há»“i chá»©ng chá»‰ (CRL)

PKCS#7 Ä‘Æ°á»£c lÆ°u trá»¯ dÆ°á»›i dáº¡ng DER hoáº·c PEM. Dáº¡ng PEM cÅ©ng giá»‘ng nhÆ° DER nhÆ°ng Ä‘Æ°á»£c mÃ£ hÃ³a Base64 vÃ  cÃ³ Ä‘áº·t â€‘â€‘â€‘â€‘â€‘BEGIN PKCS7â€‘â€‘â€‘â€‘â€‘, â€‘â€‘â€‘â€‘â€‘END PKCS7â€‘â€‘â€‘â€‘â€‘ Ä‘á»ƒ phÃ¢n biá»‡t.
